<h1>Trip Dashboard</h1>

<p><%= link_to "Home", root_path() %></p>

<h2>Trip Details</h2> 
<p><b>Name: </b> <%= @trip.name %></p>
<p><b>Destination: </b> <%= @trip.destination %></p>
<p><b>Time: <%= @trip.datetime %></p>
<% if @trip.comments %>
<p><b>Event Details: </b> <%= @trip.comments %></p>
<% end %>
<p><%= link_to "Edit Trip Details", edit_trip_path %></p>


<h2>Cars</h2>

  <p><%= link_to "Add Car", new_trip_car_path(@trip.id) %><p>

  <% @cars.each do |car| %>
  <div class="car">

    <table>
      <tr>
	<td><b>Driver: </b></td>
	<td><%= car.drivers.first.first_name %> <%= car.drivers.first.last_name %></td>
      </tr>
      <tr>
	<td><b>Departs From: </b></td>
	<td><%= car.origin %></td>
      </tr>
      <% if car.depart_datetime %>
      <tr>
	<td><b>Departs At: </b></td>
	<td>
		<% trip_date = @trip.datetime.strftime("%d/%m/%Y")
			 depart_date = car.depart_datetime.strftime("%d/%m/%Y")
		   depart_time = car.depart_datetime.strftime("%I:%M%p") %>
	  <% if depart_date != trip_date %>
	  <%= depart_date %> 
	  <% end %>
	  <%= depart_time %>
	</td>
      </tr>
      <% end %>
      <tr>
	<td><b>Remaining Seats: </b></td>
	<td><%= (car.number_of_seats - car.passengers.count).to_s %></td>
      </tr>
      <tr>
	<td><%= link_to "Details", trip_car_path(@trip.hashid, car.id) %></td>
	<td>
	  <% if car.passengers.count < car.number_of_seats %>
	  Choose Car
	  <% else %>
	  <i>Car Full</i>
	  <% end %>
	</td>
      </tr>
    </table>

  </div>
  <% end %>

